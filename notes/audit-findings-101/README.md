# Audit Findings 101

### Checklists

- [Block One: 1 - 20](./checklist/block-one.md)
- [Block Two: 21 - 40](./checklist/block-two.md)
- [Block Three: 41 - 60](./checklist/block-three.md)
- [Block Four: 61 - 80](./checklist/block-four.md)
- [Block Five: 81 - 101](./checklist/block-five.md)

### Subtopics

- [Access Controls](./subtopic/access-controls.md) - Related to authorization of users and assessment of rights
- [API Inconsistency](./subtopic/api-inconsistency.md) -
- [Auditing/Logging](./subtopic/auditing-logging.md) - Related to auditing of actions or logging of problems
- [Authentication](./subtopic/authentication.md) - Related to the identification of users
- [Code Quality](./subtopic/code-quality.md) -
- [Coding Bug](./subtopic/coding-bug.md) -
- [Configuration](./subtopic/configuration.md) - Related to security configurations of servers, devices, or software
- [Cryptography](./subtopic/cryptography.md) - Related to protecting the privacy or integrity of data
- [Data Exposure](./subtopic/data-exposure.md) - Related to unintended exposure of sensitive information
- [Data Validation](./subtopic/data-validation.md) - Related to improper reliance on the structure or values of data
- [Denial of Service](./subtopic/denial-of-service.md) - Related to causing system failure
- [Documentation](./subtopic/documentation.md) -
- [Error Reporting](./subtopic/error-reporting.md) - Related to the reporting of error conditions in a secure fashion
- [Front-running](./subtopic/front-running.md) -
- [Logic](./subtopic/logic.md) -
- [Missing Logic](./subtopic/missing-logic.md) -
- [Numerics](./subtopic/numerics.md) -
- [Patching](./subtopic/patching.md) - Related to keeping software up to date
- [Session Management](./subtopic/session-management.md) - Related to the identification of authenticated users
- [Race Condition](./subtopic/race-condition.md) -
- [Reentrancy](./subtopic/reentrancy.md) -
- [Timing](./subtopic/timing.md) - Related to race conditions, locking or order of operations
- [Undefined Behavior](./subtopic/undefined-behavior.md) - Related to undefined behavior triggered by the program
- [External Interaction](./subtopic/external-interaction.md) - Related to interactions with external programs
- [Standards](./subtopic/standards.md) - Related to complying with industry standards and best practices

### Audited Protocols

- [Aave Protocol V2](https://consensys.net/diligence/audits/2020/09/aave-protocol-v2/)
  - 5.4 Unhandled return values of `transfer` and `transferFrom` - Medium
- [DeFi Saver](https://consensys.net/diligence/audits/2021/03/defi-saver/)
  - 5.1 Random task execution - Critical
  - 5.2 Tokens with more than 18 decimal points will cause issues - Major
  - 5.3 Error codes of Compound's `Comptroller.enterMarket`, `Comptroller.exitMarket` are not checked - Major
  - 5.4 Reversed order of parameters in `allowance` function call - Medium
- [DAOfi](https://consensys.net/diligence/audits/2021/02/daofi/)
  - 4.1 Token approvals can be stolen in `DAOfiV1Router01.addLiquidity()` - Critical
  - 4.4 The `swapExactTokensForETH` checks the wrong return value - Major
  - 4.5 `DAOfiV1Pair.deposit()` accepts deposits of zero, blocking the pool - Medium
- [Fei Protocol](https://consensys.net/diligence/audits/2021/01/fei-protocol/)
  - 3.1 `GenesisGroup.commit` overwrites previously-committed values - Critical
  - 3.2 Purchasing and committing still possible after launch - Critical
  - 3.3 `UniswapIncentive` overflow on pre-transfer hooks - Major
  - 3.4 `BondingCurve` allows users to acquire FEI before launch - Medium
  - 3.5 `Timed.isTimeEnded` returns `true` if the timer has not been initialized - Medium
  - 3.6 Overflow/underflow protection - Medium
  - 3.7 Unchecked return value for `IWETH.transfer` call - Medium
  - 3.8 `GenesisGroup.emergencyExit` remains functional after launch - Medium
- [bitbank](https://consensys.net/diligence/audits/2020/11/bitbank/)
  - 5.1 ERC20 tokens with no return value will fail to transfer - Major
- [Metaswap](https://consensys.net/diligence/audits/2020/08/metaswap/)
  - 4.1 Reentrancy vulnerability in `MetaSwap.swap()` - Major
  - 4.2 A new malicious adapter can access users' tokens - Medium
  - 4.3 Owner can front-run traders by updating adapters - Medium
- [mStable 1.1](https://consensys.net/diligence/audits/2020/07/mstable-1.1/)
  - 6.2 Users can collect interest from `SavingsContract` by only staking mTokens momentarily - Major
- [Bancor V2 AMM](https://consensys.net/diligence/audits/2020/06/bancor-v2-amm-security-audit/)
  - 5.1 Oracle updates can be manipulated to perform atomic front-running attack - Critical
- [Shell Protocol](https://consensys.net/diligence/audits/2020/06/shell-protocol/)
  - 6.2 Certain functions lack input validation routines - Major
  - 6.3 Remove `Loihi` methods that can be used as backdoors by the administrator - Major
- [Lien Protocol](https://consensys.net/diligence/audits/2020/05/lien-protocol/)
  - 3.1 A reverting fallback function will lock up all payouts - Critical
- [The LAO](https://consensys.net/diligence/audits/2020/01/the-lao/)
  - 5.1 `safeRagequit` makes you lose funds - Critical
  - 5.2 Creating proposal is not trustless - Critical
  - 5.3 Emergency processing can be blocked - Critical
  - 5.4 Token Overflow might result in system halt or loss of funds - Major
  - 5.5 Whitelisted tokens limit - Major
  - 5.6 Summoner can steal funds using `bailout` - Major
  - 5.7 Sponsorship front-running - Major
  - 5.8 Delegate assignment front-running - Medium
- [Origin Dollar](https://github.com/trailofbits/publications/blob/master/reviews/OriginDollar.pdf)
  - [6 Queued transactions cannot be canceled - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/access-controls.md#queued-transactions-cannot-be-cancelled)
  - [8 Proposal transactions can be executed separately and block `Proposal.execute` call - High]()
  - [9 Proposals could allow `Timelock.admin` takeover - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#proposals-could-allow-timelockadmin-takeover)
  - [10 Reentrancy and untrusted contract call in `mintMultiple` - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#reentrancy-and-untrusted-contract-call-in-mintmultiple)
  - 19 Lack of return value checks can lead to unexpected results - High
  - 20 External calls in loop can lead to denial of service - High
  - [22 OUSD allows users to transfer more tokens than expected - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#ousd-allows-users-to-transfer-more-tokens-than-expected)
  - [23 OUSD total supply can be arbitrary, even smaller than user balances - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#ousd-total-supply-can-be-arbitrary-even-smaller-than-user-balances)
- [Yield Protocol](https://github.com/trailofbits/publications/blob/master/reviews/YieldProtocol.pdf)
  - 1 Flash minting can be used to redeem `fyDAI` - Medium
  - [4 Lack of `chainID` validation allows signatures to be re-used across forks - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/access-controls.md#lack-of-chainid-validation-allows-signatures-to-be-re-used-across-forks)
- [Hermez](https://github.com/trailofbits/publications/blob/master/reviews/hermez.pdf)
  - [1 Lack of a contract existence check allows token theft - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#lack-of-a-contract-existence-check-allows-token-theft)
  - 2 No incentive for bidders to vote earlier - Medium
  - [5 Lack of access control separation is risky - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/access-controls.md#lack-of-access-control-separation-is-risky)
  - [6 Lack of two-step procedure for critical operations leaves them error-prone - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#lack-of-two-step-procedure-for-critical-operations-leaves-them-error-prone)
  - [12 Initialization functions can be front-run - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/configuration.md#initialization-functions-can-be-front-run)
- [Uniswap V3](https://github.com/Uniswap/v3-core/blob/main/audits/tob/audit.pdf)
  - [1 Missing validation of `_owner` argument could indefinitely lock owner role - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#missing-validation-of-_owner-argument-could-indefinitely-lock-owner-role)
  - [5 Incorrect comparison enables swapping and token draining at no cost - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#incorrect-comparison-enables-swapping-and-token-draining-at-no-cost)
  - [6 Unbound loop enables denial of service - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#unbound-loop-enables-denial-of-service)
  - [7 Front-running pool's initialization can lead to draining of liquidity provider's initial deposits - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#front-running-pools-initialization-can-lead-to-draining-of-liquidity-providers-initial-deposits)
  - [8 Swapping on zero liquidity allows for control of the pool's price - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#swapping-on-zero-liquidity-allows-for-control-of-the-pools-price)
  - [9 Failed transfer may be overlooked due to lack of contract existence check - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#failed-transfer-may-be-overlooked-due-to-lack-of-contract-existence-check)
- [DFX Finance](https://github.com/dfx-finance/protocol/blob/main/audits/2021-05-03-Trail_of_Bits.pdf)
  - 1 Assimilators use a deprecated Chainlink API - Undetermined
  - 10 Use of undefined behavior in equality check - High
  - [12 Assimilators' balance functions return raw values - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#assimilators-balance-functions-return-raw-values)
  - [13 System always assumes USDC is equivalent to USD - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#system-always-assumes-usdc-is-equivalent-to-usd)
- [0x Protocol](https://github.com/trailofbits/publications/blob/master/reviews/0x-protocol.pdf)
  - 2 Market makers have a reduced cost for performing front-running attacks - Medium
  - [3 `cancelOrdersUpTo` can be used to permanently block future orders - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#cancelordersupto-can-be-used-to-permanently-block-future-orders)
  - 4 `setSignatureValidatorApproval` race condition may be exploitable - Medium
  - 6 Batch processing of transaction execution and order matching may lead to exchange griefing - Medium
  - [7 Zero fee orders are possible if a user performs transactions with a zero gas price - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#zero-fee-orders-are-possible-if-a-user-performs-transactions-with-a-zero-gas-price)
  - 13 Specification-Code mismatch for `AssetProxyOwner` timelock period - High
  - [17 Unclear documentation on how order filling can fail - High](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#unclear-documentation-on-how-order-filling-can-fail)
  - [21 Calls to `setParams` may set invalid values and produce unexpected behavior in the staking contracts - Medium](https://github.com/broccolirob/audit-sandbox/blob/master/notes/audit-findings-101/subtopic/data-validation.md#calls-to-setparams-may-set-invalid-values-and-produce-unexpected-behavior-in-the-staking-contracts)
- [Synthetix EtherCollateral](https://github.com/sigp/public-audits/blob/master/synthetix/ethercollateral/review.pdf)
  - 1 Improper supply cap limitation enforcement - High
  - 2 Improper storage management of open loan accounts - High
  - 3 Contract owner can arbitrarily change minting fees and interest rates - Medium
- [InfiniGold](https://github.com/sigp/public-audits/blob/master/infinigold/review.pdf)
  - 1 Inadequate proxy implementation preventing contract upgrades - Critical
  - 2 Blacklisting bypass via `transferFrom()` function - High
- [Synthetix Unipool](https://github.com/sigp/public-audits/blob/master/synthetix/unipool/review.pdf)
  - 1 Wrong order of operations leads to exponentiation of `rewardPerTokenStored` - Critical
  - 2 Staking before initial `notifyRewardAmount` can lead to disproportionate rewards - High
  - 3 External call reverts if period has not elapsed - High
  - 4 Gap between periods can lead to erroneous rewards - Medium
- [Chainlink](https://github.com/sigp/public-audits/blob/master/chainlink-1/review.pdf)
  - 2 Malicious users can DOS/Hijack requests from chainlinked contracts - High
- [UMA Phase 4](https://blog.openzeppelin.com/uma-audit-phase-4/)
  - M01 Lack of event emission after sensitive actions - Medium
  - M02 Functions with unexpected side-effects - Medium
- [1inch Liquidity Protocol](https://blog.openzeppelin.com/1inch-liquidity-protocol-audit/)
  - M01 Mooniswap pairs cannot be unpaused - Medium
- [Futureswap V2](https://blog.openzeppelin.com/futureswap-v2-audit/)
  - H01 Attackers can prevent honest users from performing an instant withdraw from the Wallet contract - High
  - M01 Not using upgrade safe contracts in `FsToken` inheritance - Medium
  - M03 Unchecked output of the ECDSA `recover` function - Medium
- [Notional Protocol](https://blog.openzeppelin.com/notional-audit/)
  - M02 Adding new variables to multi-level inherited upgradeable contracts may break storage layout - Medium
- [GEB Protocol](https://blog.openzeppelin.com/geb-protocol-audit/)
  - M07 Unsafe division in `rdivide` and `wdivide` functions - Medium
- [1inch Exchange Audit](https://blog.openzeppelin.com/1inch-exchange-audit/)
  - M03 Incorrect `safeApprove` usage - Medium
- [Opyn Gamma Protocol](https://blog.openzeppelin.com/opyn-gamma-protocol-audit/)
  - H01 ETH could get trapped in the protocol - High
  - M04 Use of transfer might render ETH impossible to withdraw - Medium
- [Endaoment](https://blog.openzeppelin.com/endaoment-audit/)
  - H02 Not following the Checks-Effects-Interactions pattern - High
- [Audius](https://blog.openzeppelin.com/audius-contracts-audit/)
  - H03 Updating the Governance registry and Guardian addresses emits no events - High
  - H07 The quorum requirement can be trivially bypassed with sybil accounts - High
  - M02 Inconsistently checking initialization - Medium
  - M06 Voting period and quorum can be set to zero - Medium
  - M10 Some state variables are not set during initialize - Medium
- [Primitive](https://blog.openzeppelin.com/primitive-audit/)
  - M08 Expired and/or paused options can still be traded - Medium
- [ACO Protocol](https://blog.openzeppelin.com/aco-protocol-audit/)
  - M01 `ERC20` transfers can misbehave - Medium
- [Compound Open Price Feed](https://blog.openzeppelin.com/compound-open-price-feed-uniswap-integration-audit/)
  - M04 Incorrect event emission - Medium
- [MCDEX Mai Protocol](https://blog.openzeppelin.com/mcdex-mai-protocol-audit/)
  - C01 Anyone can liquidate on behalf of another account - Critical
  - C02 Orders cannot be cancelled - Critical
  - M03 Reentrancy possibilities - Medium
  - M06 Governance parameter changes should not be instant - Medium
- [UMA Phase 1](https://blog.openzeppelin.com/uma-audit-phase-1/)
  - H01 Votes can be duplicated - High
